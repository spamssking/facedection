<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Emotion Detection App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f0f2f5;
            text-align: center;
            padding: 50px;
        }

        .container {
            background: #fff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            display: inline-block;
        }

        img {
            max-width: 300px;
            border-radius: 8px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Facial Emotion Recognition</h2>
        <form action="/predict" method="post" enctype="multipart/form-data">
            <input type="file" name="image" accept="image/*" required><br><br>
            <button type="submit">Upload & Predict</button>
        </form>

        <hr>

        <h3>Or Use Your Webcam:</h3>
        <button onclick="startWebcam()">Start Live Feed</button>
        <button onclick="stopWebcam()">Stop Live Feed</button>
        <br><br>
        <img id="videoFeed" src="" width="400" alt="Webcam feed will appear here">


        {% if filename %}
        <h3>Result:</h3>
        <img src="{{ url_for('static', filename='uploads/' + filename) }}" alt="User Image">
        <p><strong>Predicted Emotion:</strong> {{ emotion }}</p>
        {% elif emotion %}
        <p><strong>{{ emotion }}</strong></p>
        {% endif %}
    </div>

    <script>
    let webcamActive = false;

    function startWebcam() {
        if (!webcamActive) {
            document.getElementById('videoFeed').src = "{{ url_for('video_feed') }}";
            webcamActive = true;
        }
    }

    function stopWebcam() {
        const video = document.getElementById('videoFeed');
        video.src = "";  // Stop the stream
        webcamActive = false;
    }
    </script>

</body>

</html>
